<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Collaborative Canvas</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="welcomeModal" class="modal-overlay">
        <div class="modal-content glass-panel">
            <h1 class="text-4xl font-bold mb-4 bg-gradient-to-r from-blue-400 via-purple-500 to-pink-500 bg-clip-text text-transparent">
                Collaborative Canvas
            </h1>
            <p class="text-gray-300 mb-6">Enter your name to start drawing</p>
            <input 
                type="text" 
                id="userNameInput" 
                placeholder="Your name" 
                class="input-field"
                maxlength="20"
            >
            <button id="joinButton" class="btn-primary">
                Join Canvas
            </button>
            <div class="mt-4 text-sm text-gray-400">
                <p>Share this room: <span id="roomIdDisplay" class="font-mono text-purple-400"></span></p>
            </div>
        </div>
    </div>

    <div id="app" class="hidden">
        <div class="top-bar glass-panel">
            <div class="flex items-center gap-4">
                <button id="menuToggle" class="icon-btn">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
                <h2 class="text-xl font-semibold text-white">Collaborative Canvas</h2>
            </div>
            
            <div class="flex items-center gap-4">
                <div id="usersList" class="flex items-center gap-2"></div>
                
                <button id="themeToggle" class="icon-btn" title="Toggle theme">
                    <svg id="themeIcon" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
                    </svg>
                </button>
                
                <button id="exportButton" class="icon-btn" title="Export as PNG">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                    </svg>
                </button>
                
                <button id="shareButton" class="icon-btn" title="Share room">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"></path>
                    </svg>
                </button>
            </div>
        </div>

        <div id="sidebar" class="sidebar glass-panel">
            <div class="tool-section">
                <h3 class="section-title">Tools</h3>
                <div class="tool-grid">
                    <button class="tool-btn active" data-tool="brush" title="Brush">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"></path>
                        </svg>
                    </button>
                    <button class="tool-btn" data-tool="eraser" title="Eraser">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                        </svg>
                    </button>
                    <button class="tool-btn" data-tool="line" title="Line">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14"></path>
                        </svg>
                    </button>
                    <button class="tool-btn" data-tool="rectangle" title="Rectangle">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16v12H4z"></path>
                        </svg>
                    </button>
                    <button class="tool-btn" data-tool="circle" title="Circle">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 12m-10 0a10 10 0 1 1 20 0a10 10 0 1 1 -20 0"></path>
                        </svg>
                    </button>
                    <button class="tool-btn" data-tool="text" title="Text">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7"></path>
                        </svg>
                    </button>
                </div>
            </div>

            <div class="tool-section">
                <h3 class="section-title">Line Color</h3>
                <div class="color-picker-container">
                    <div id="colorGradientPicker" class="color-gradient-picker"></div>
                    <input type="range" id="colorHueSlider" class="color-hue-slider" min="0" max="360" value="0">
                    <div class="color-palette">
                        <div class="color-swatch active" data-color="#000000" style="background: #000000;"></div>
                        <div class="color-swatch" data-color="#FFFFFF" style="background: #FFFFFF; border: 1px solid #d2d2d7;"></div>
                        <div class="color-swatch" data-color="#FF9500" style="background: #FF9500;"></div>
                        <div class="color-swatch" data-color="#FF3B30" style="background: #FF3B30;"></div>
                        <div class="color-swatch" data-color="#AF52DE" style="background: #AF52DE;"></div>
                        <div class="color-swatch" data-color="#007AFF" style="background: #007AFF;"></div>
                        <div class="color-swatch" data-color="#34C759" style="background: #34C759;"></div>
                        <div class="color-swatch" data-color="#FFCC00" style="background: #FFCC00;"></div>
                        <div class="color-swatch" data-color="#5856D6" style="background: #5856D6;"></div>
                    </div>
                    <input type="color" id="colorPicker" class="color-input" value="#000000">
                </div>
            </div>

            <div class="tool-section">
                <h3 class="section-title">Line Size</h3>
                <div class="slider-container vertical-slider">
                    <input type="range" id="strokeWidth" min="1" max="50" value="5" class="slider vertical" orient="vertical">
                    <span id="strokeWidthValue" class="slider-value">5px</span>
                </div>
            </div>

            <div class="tool-section">
                <h3 class="section-title">Opacity</h3>
                <div class="slider-container">
                    <input type="range" id="opacity" min="0" max="100" value="100" class="slider">
                    <span id="opacityValue" class="slider-value">100%</span>
                </div>
            </div>

            <div class="tool-section">
                <h3 class="section-title">Actions</h3>
                <div class="action-buttons">
                    <button id="undoBtn" class="action-btn" title="Undo (Ctrl+Z)">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"></path>
                        </svg>
                        Undo
                    </button>
                    <button id="redoBtn" class="action-btn" title="Redo (Ctrl+Shift+Z)">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 10h-10a8 8 0 00-8 8v2M21 10l-6 6m6-6l-6-6"></path>
                        </svg>
                        Redo
                    </button>
                    <button id="clearBtn" class="action-btn danger" title="Clear Canvas">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                        </svg>
                        Clear
                    </button>
                    <button id="exportCanvasBtn" class="action-btn" title="Export Canvas">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                        </svg>
                        Export PNG
                    </button>
                </div>
            </div>

            <div class="tool-section">
                <h3 class="section-title">Zoom</h3>
                <div class="zoom-controls">
                    <button id="zoomIn" class="zoom-btn">+</button>
                    <span id="zoomLevel" class="zoom-value">100%</span>
                    <button id="zoomOut" class="zoom-btn">-</button>
                    <button id="zoomReset" class="zoom-btn">Reset</button>
                </div>
            </div>
        </div>

        <div class="canvas-container">
            <canvas id="drawingCanvas"></canvas>
            <div id="cursorsLayer" class="cursors-layer"></div>
        </div>

        <div id="chatPanel" class="chat-panel glass-panel">
            <div class="chat-header">
                <button id="chatToggle" class="icon-btn">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                    </svg>
                </button>
                <h3 class="chat-title">Collaboration</h3>
            </div>
            <div class="chat-users">
                <div class="user-item">
                    <div class="user-avatar-small" style="background: #007AFF;">U</div>
                    <span class="user-name">You</span>
                </div>
            </div>
            <div id="chatMessages" class="chat-messages">
                <p class="chat-help">/help shows the list of available commands</p>
            </div>
            <div class="chat-input-container">
                <input type="text" id="chatInput" class="chat-input" placeholder="Type a message...">
                <button id="chatSend" class="chat-send-btn">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script type="module" src="main.js"></script>
</body>
</html>

